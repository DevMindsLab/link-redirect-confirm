(()=>{var t={n:r=>{var e=r&&r.__esModule?()=>r.default:()=>r;return t.d(e,{a:e}),e},d:(r,e)=>{for(var n in e)t.o(e,n)&&!t.o(r,n)&&Object.defineProperty(r,n,{enumerable:!0,get:e[n]})},o:(t,r)=>Object.prototype.hasOwnProperty.call(t,r)};(()=>{"use strict";function r(t,e){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},r(t,e)}const e=flarum.core.compat["forum/app"];var n=t.n(e);const o=flarum.core.compat["common/components/Modal"];var a=t.n(o);const i=flarum.core.compat["common/components/Button"];var c=t.n(i),l=function(t){function e(){return t.apply(this,arguments)||this}var o,a;a=t,(o=e).prototype=Object.create(a.prototype),o.prototype.constructor=o,r(o,a);var i=e.prototype;return i.oninit=function(r){t.prototype.oninit.call(this,r),this.url=r.attrs.url},i.className=function(){return"Modal--small LinkRedirectConfirmModal"},i.title=function(){return n().translator.trans("devmindslab-link-redirect-confirm.forum.modal.title")},i.content=function(){var t=this,r=this.url||"";return m("div",{className:"Modal-body"},m("p",null,n().translator.trans("devmindslab-link-redirect-confirm.forum.modal.body")),r?m("p",{className:"LinkRedirectConfirmModal-link"},n().translator.trans("devmindslab-link-redirect-confirm.forum.modal.link",{url:r})):null,m("div",{className:"Form-group"},c().component({className:"Button Button--secondary",onclick:function(){return t.hide()}},n().translator.trans("devmindslab-link-redirect-confirm.forum.modal.cancel")),m("a",{className:"Button Button--primary",href:this.url||"#",target:"_blank",rel:"noopener noreferrer","data-no-redirect-confirm":"1",onclick:function(){return t.hide()}},n().translator.trans("devmindslab-link-redirect-confirm.forum.modal.confirm"))))},e}(a());function u(t,r){return r.some(function(r){return function(t,r){if(!r)return!1;var e=function(t){if(!t)return"";var r=t.trim();return(r=(r=(r=(r=r.replace(/^https?:\/\//i,"")).split("/")[0]).split("?")[0]).split("#")[0]).trim()}(r),n=e.replace(/^\*\./,"").toLowerCase(),o=t.toLowerCase();return o===n||o.endsWith("."+n)}(t,r)})}n().initializers.add("devmindslab-link-redirect-confirm",function(){var t=n().forum&&n().forum.attribute&&n().forum.attribute("baseUrl")||n().forum&&n().forum.attribute&&n().forum.attribute("base_url")||n().data&&n().data.attributes&&n().data.attributes.baseUrl||"",r="";try{r=new URL(t).hostname}catch(t){r=window.location.hostname}document.addEventListener("click",function(e){var o=e.target&&e.target.closest?e.target.closest("a"):null;if(!function(t,r){return!(r&&r.href&&!r.hasAttribute("data-no-redirect-confirm")&&!t.defaultPrevented&&(!t.button||0===t.button))}(e,o)){var a;try{a=new URL(o.getAttribute("href"),t||window.location.href)}catch(t){return}if(["http:","https:"].includes(a.protocol)){var i,c=(i=n().forum&&n().forum.attribute&&n().forum.attribute("linkRedirectConfirmWhitelist")||n().data&&n().data.attributes&&n().data.attributes.linkRedirectConfirmWhitelist||n().data&&n().data.settings&&n().data.settings["devmindslab-link-redirect-confirm.whitelist"]||"",i?i.split(/[,\s]+/).map(function(t){return t.trim()}).filter(Boolean):[]).concat([r]),s=function(t,r,e){return!(!t||!t.hostname||t.hostname.toLowerCase()===r.toLowerCase()||u(t.hostname,e))}(a,r,c);s&&(u(a.hostname,c)||(e.preventDefault(),e.stopPropagation(),n().modal.show(l,{url:a.href})))}}},!0)})})(),module.exports={}})();
//# sourceMappingURL=forum.js.map